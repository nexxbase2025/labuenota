
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<link rel="apple-touch-icon" href="icono.webp" />
<title>LA BUENOTA RADIO ONLINE</title>
<link rel="manifest" href="manifest.json" />
<link rel="stylesheet" href="style.css" />
<style>
  body {
    margin: 0; 
    padding: 0;
    font-family: Arial, sans-serif;
    overflow-x: hidden;
    color: #fff;
    background: linear-gradient(120deg, #000000, #ff0000, #000000);
    background-size: 400% 400%;
    animation: gradientAnimation 15s ease infinite;
  }
  img#logo { position: fixed; top: 5px; left: 50%; transform: translateX(-50%); width: 300px; z-index: 9999; }
  .gallery-scroll { position: fixed; bottom: 200px; left: 0; width: 100%; overflow-x: auto; display: flex; gap: 10px; padding-left: 50vw; padding-right: 50vw; box-sizing: border-box; z-index: 9998; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; justify-content: flex-start; scroll-padding-left: 50vw; scroll-padding-right: 50vw; }
  .gallery-item { flex: 0 0 auto; width: 70vw; aspect-ratio: 16 / 9; scroll-snap-align: center; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.6); }
  .gallery-item img { width: 100%; height: 100%; object-fit: cover; display: block; border-radius: 12px; }
  .social-row-abajo { position: fixed; bottom: 125px; left: 50%; transform: translateX(-50%); display: flex; gap: 15px; z-index: 10001; }
  .social-row-abajo a { background: #fff; padding: 4px; border-radius: 50%; box-shadow: 0 4px 10px rgba(0,0,0,0.4); display: flex; justify-content: center; align-items: center; transition: transform 0.3s ease; }
  .social-row-abajo a:hover { transform: scale(1.15); }
  .social-row-abajo img { width: 40px; height: 40px; }
  .radio-player { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #222; padding: 12px 20px; border-radius: 25px; display: flex; align-items: center; gap: 15px; box-shadow: 0 0 20px ; z-index: 10002; }
  .play-btn { font-size: 26px; width: 48px; height: 48px; border: none; border-radius: 50%; background: #f1bd02; color: white; cursor: pointer; box-shadow: 0 0 10px #f1bd02; display: flex; justify-content: center; align-items: center; user-select: none; }
  .play-btn:focus { outline: 2px solid #fff; }
  .spectrum { display: flex; justify-content: center; align-items: flex-end; gap: 4px; height: 40px; width: 150px; margin: auto; margin-top: 10px; z-index: 999; }
  .bar { width: 4px; background: lime; animation: bounce 1s infinite ease-in-out; transition: height 0.1s ease; }
  #install-bubble { display: none; position: fixed; bottom: 120px; right: 20px; background: #eaff00; color: rgb(5, 5, 5); padding: 10px 15px; border-radius: 25px; font-weight: bold; font-size: 15px; cursor: pointer; box-shadow: 0 0 15px #ff6a00cc; z-index: 99999; }
  #ios-install-prompt { position: fixed; bottom: 20px; left: 20px; right: 20px; background: rgba(0,0,0,0.9); color: white; padding: 16px; border-radius: 12px; font-size: 14px; text-align: center; z-index: 99999; box-shadow: 0 4px 12px rgba(0,0,0,0.5); display: none; }
  #ios-install-prompt button { margin-top: 8px; background: #ff4444; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: bold; }
  #peli-bubble { position: fixed; bottom: 400px; left: 50%; transform: translateX(-50%); background: #f1bd02; color: rgb(4, 4, 4); padding: 10px 15px; border-radius: 25px; font-weight: bold; font-size: 15px; cursor: pointer; box-shadow: 0 0 15px #ffffff; z-index: 10002; text-align: center; white-space: nowrap; display: inline-block; }
</style>
</head>
<body>

<img src="ivibra.webp" id="logo" alt="Logo Ivibra" />
<div id="peli-bubble">üé¨ LA PELI DE LA SEMANA</div>

<nav class="social-row-abajo" aria-label="Redes sociales">
  <a href="https://wa.me/593984827009" target="_blank" rel="noopener"><img src="what.webp" alt="WhatsApp" /></a>
  <a href="https://www.facebook.com/labuenotaradioonline" target="_blank" rel="noopener"><img src="face.webp" alt="Facebook" /></a>
  <a href="https://www.instagram.com/guillermo_villagran_delgado/reel/DGLaDCZJuHX/" target="_blank" rel="noopener"><img src="ins.webp" alt="Instagram" /></a>
  <a href="https://www.tiktok.com/@radiomaxsoloexitos" target="_blank" rel="noopener"><img src="tik.webp" alt="TikTok" /></a>
</nav>

<div class="gallery-scroll">
  <div class="gallery-item"><img src="r1.webp" alt="Promo 1" /></div>
  <div class="gallery-item"><img src="r2.webp" alt="Promo 2" /></div>
  <div class="gallery-item"><img src="r3.webp" alt="Promo 3" /></div>
  <div class="gallery-item"><img src="r4.webp" alt="Promo 4" /></div>
  <div class="gallery-item"><img src="r5.webp" alt="Promo 5" /></div>
  <div class="gallery-item"><img src="r6.webp" alt="Promo 6" /></div>
</div>

<div class="radio-player">
  <button class="play-btn" id="playPauseBtn">‚ñ∂</button>
  <div class="spectrum" id="spectrum"></div>
</div>

<audio id="audio" preload="auto" src="https://stream.zeno.fm/jpsr5zsxjlguv"></audio>

<div id="install-bubble">üì≤ Instalar app</div>
<div id="ios-install-prompt">
  üì≤ Para instalar esta app en iPhone, pulsa <strong>Compartir</strong> ‚Üí <strong>Y luego A√±adir a pantalla de inicio</strong>.
  <br /><button id="closeIosPromptBtn">Cerrar</button>
</div>

<script>
const audio = document.getElementById('audio');
const playPauseBtn = document.getElementById('playPauseBtn');
const spectrum = document.getElementById('spectrum');
const installBubble = document.getElementById('install-bubble');
const iosInstallPrompt = document.getElementById('ios-install-prompt');
const closeIosPromptBtn = document.getElementById('closeIosPromptBtn');
const peliBubble = document.getElementById('peli-bubble');

let isPlaying = false;
let animationId;
let deferredPrompt;
let peliWindow = null;

// === AUDIO CONTEXT para iOS/Android mantener audio activo con pantalla apagada ===
const AudioContext = window.AudioContext || window.webkitAudioContext;
const audioCtx = new AudioContext();
const track = audioCtx.createMediaElementSource(audio);
track.connect(audioCtx.destination);

// Crear barras espectro
const bars = [];
for(let i=0;i<16;i++){
  const bar = document.createElement('div');
  bar.className='bar';
  spectrum.appendChild(bar);
  bars.push(bar);
}
function animateFakeSpectrum(){
  bars.forEach(bar => { bar.style.height = `${Math.random()*100}%`; });
  const logo = document.getElementById('logo');
  if(logo) logo.style.transform = `translateX(-50%) scale(${1+Math.random()*0.1})`;
  animationId=requestAnimationFrame(animateFakeSpectrum);
}

// Play/Pause radio
playPauseBtn.addEventListener('click', async () => {
  if(!isPlaying){
    if(audioCtx.state==='suspended'){ await audioCtx.resume(); }
    audio.play().then(()=>{ playPauseBtn.textContent='‚è∏'; isPlaying=true; animateFakeSpectrum(); }).catch(()=>{});
  } else {
    audio.pause(); playPauseBtn.textContent='‚ñ∂'; isPlaying=false; cancelAnimationFrame(animationId);
  }
});

// Desbloquear audio al primer toque en Android/iOS
document.addEventListener('touchstart', async ()=>{
  if(audioCtx.state==='suspended'){ await audioCtx.resume(); }
  audio.play().then(()=>{ audio.pause(); }).catch(()=>{});
},{once:true});

// Reiniciar spectrum al volver a la pesta√±a visible
document.addEventListener('visibilitychange', ()=>{
  if(document.visibilityState==='visible' && isPlaying){
    cancelAnimationFrame(animationId);
    animateFakeSpectrum();
  }
});

// Android instal
window.addEventListener('beforeinstallprompt', (e)=>{
  e.preventDefault(); deferredPrompt=e; installBubble.style.display='block';
});
installBubble.addEventListener('click', async ()=>{
  installBubble.style.display='none';
  if(deferredPrompt){ deferredPrompt.prompt(); await deferredPrompt.userChoice; deferredPrompt=null; }
});

// iOS instal
function isIos(){ return /iphone|ipad|ipod/i.test(navigator.userAgent); }
function isInStandaloneMode(){ return ('standalone' in window.navigator)&&window.navigator.standalone; }
document.addEventListener('DOMContentLoaded', ()=>{
  if(isIos()&&!isInStandaloneMode()&&!localStorage.getItem('iosPromptShown')) iosInstallPrompt.style.display='block';
});
closeIosPromptBtn.addEventListener('click', ()=>{
  iosInstallPrompt.style.display='none';
  localStorage.setItem('iosPromptShown','true');
});

// PELI
peliBubble.addEventListener('click', ()=>{
  if(isPlaying){ audio.pause(); cancelAnimationFrame(animationId); }
  peliWindow = window.open('peli.html','_blank','width='+screen.width+',height='+screen.height+',fullscreen=yes');
  window.addEventListener('message', (e)=>{
    if(e.data==='adPlaying'){
      const soundBubble = document.createElement('button');
      soundBubble.id='adSoundBubble';
      soundBubble.textContent='üîä Activar sonido';
      soundBubble.style.position='fixed';
      soundBubble.style.bottom='50px';
      soundBubble.style.right='20px';
      soundBubble.style.background='rgba(255,255,255,0.9)';
      soundBubble.style.color='#000';
      soundBubble.style.border='none';
      soundBubble.style.borderRadius='25px';
      soundBubble.style.padding='10px 15px';
      soundBubble.style.fontSize='14px';
      soundBubble.style.cursor='pointer';
      soundBubble.style.zIndex='10003';
      document.body.appendChild(soundBubble);
      soundBubble.onclick = ()=>{
        e.source.postMessage('unmute','*');
        soundBubble.remove();
      };
    }
    if(e.data==='adEnded'){
      const existingBubble=document.getElementById('adSoundBubble');
      if(existingBubble) existingBubble.remove();
    }
    if(e.data==='resumeRadio'){
      if(audioCtx.state==='suspended'){ audioCtx.resume().then(()=>{ audio.play(); playPauseBtn.textContent='‚è∏'; isPlaying=true; animateFakeSpectrum(); }); }
      else { audio.play().then(()=>{ playPauseBtn.textContent='‚è∏'; isPlaying=true; animateFakeSpectrum(); }); }
    }
  });
});
</script>
</body>
</html>






