
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>LA PELI DE LA SEMANA</title>
<style>
  body {margin:0; padding:0; background:black; overflow:hidden;}
  video {
    width:100vw; height:100vh;
    object-fit:contain;
    background:black;
  }
  #backButton {
    position: fixed;
    top: 20px; left: 20px;
    background: rgba(0,0,0,0.6);
    color: #fff;
    border: none; border-radius: 50%;
    padding: 10px 15px; font-size: 18px;
    cursor: pointer;
    display: none; z-index: 10000;
  }
  #activateSound {
    position: fixed;
    bottom: 30px; left: 50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,0.9);
    color: #000;
    border: none; border-radius: 25px;
    padding: 10px 20px; font-size: 16px;
    cursor: pointer;
    display: none;
    z-index: 10001;
  }
</style>
</head>
<body>

<video id="movie" controls playsinline webkit-playsinline>
  <source src="https://ia800802.us.archive.org/5/items/idiocracia-2006-brrip-m-720p-x-264-ac-3-es/Idiocracia%20%282006%29%20%5BBRrip%20m720p%20x264%20AC3%28ES%29%5D.mp4" type="video/mp4">
  Tu navegador no soporta el video.
</video>

<button id="backButton">⟵</button>
<button id="activateSound">Activar sonido</button>

<script>
const movie = document.getElementById('movie');
const backButton = document.getElementById('backButton');
const activateSound = document.getElementById('activateSound');

const adInterval = 10*60; // 10 minutos
let nextAdTime = adInterval;
let adPlaying = false;
let hideTimeout;

// Detect Android
const isAndroid = /Android/i.test(navigator.userAgent);

// Guardar tiempo de película antes del anuncio
let movieTimeBeforeAd = 0;

// Mostrar botón regresar
document.addEventListener('click', () => {
  backButton.style.display = 'block';
  clearTimeout(hideTimeout);
  hideTimeout = setTimeout(()=>{ backButton.style.display='none'; }, 4000);
});
backButton.addEventListener('click', ()=>{ window.location.href='index.html'; });

// Ajuste de tamaño
function adjustVideoSize(){
  movie.style.width = window.innerWidth + "px";
  movie.style.height = window.innerHeight + "px";
}
window.addEventListener('resize', adjustVideoSize);
window.addEventListener('orientationchange', adjustVideoSize);
adjustVideoSize();

// Temporizador para anuncios cada 10 minutos usando timeupdate
movie.addEventListener('timeupdate', () => {
  if(!adPlaying && movie.currentTime >= nextAdTime){
    nextAdTime += adInterval;
    playAd();
  }
});

// Función reproducir anuncio
async function playAd(){
  adPlaying = true;

  // Guardar tiempo actual de la película
  movieTimeBeforeAd = movie.currentTime;

  movie.pause();

  const originalSrc = movie.querySelector('source').src;
  const originalType = movie.querySelector('source').type;

  // Cambiar video a anuncio
  movie.src = "https://ia601300.us.archive.org/15/items/youtube-L4PVw0oaZSo/L4PVw0oaZSo.mp4";
  movie.querySelector('source').type = "video/mp4";
  movie.load();

  // Android: autoplay seguro en mute
  if(isAndroid){
    movie.muted = true;
    try{ 
      await movie.play(); 
    } catch(e){
      activateSound.style.display = 'block';
    }
  } else {
    movie.muted = false;
    movie.play().catch(()=>{});
  }

  // Mostrar burbuja de sonido solo en Android
  activateSound.style.display = isAndroid ? 'block' : 'none';
  activateSound.onclick = () => {
    movie.muted = false;
    movie.play().catch(()=>{});
    activateSound.style.display = 'none';
  };

  // Al terminar el anuncio, volver a la película rápidamente
  const onAdEnded = () => {
    movie.removeEventListener('ended', onAdEnded);

    movie.src = originalSrc;
    movie.querySelector('source').type = originalType;
    movie.load();

    // Restaurar tiempo donde se pausó
    movie.currentTime = movieTimeBeforeAd;

    movie.muted = false;
    movie.play().catch(()=>{});
    adPlaying = false;

    // Ocultar burbuja al terminar
    activateSound.style.display = 'none';
  };
  movie.addEventListener('ended', onAdEnded);
}

// Primer toque desbloquea audio en iOS/Android
document.addEventListener('touchstart', ()=>{
  movie.load();
}, {once:true});

</script>

</body>
</html>























