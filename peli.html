
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>LA PELI DE LA SEMANA</title>
<style>
  body {margin:0; padding:0; background:black; overflow:hidden;}
  video {
    width:100vw; height:100vh;
    object-fit:contain;
    background:black;
  }
  /* Quitar botón de descarga */
  video::-internal-media-controls-download-button {
    display: none;
  }
  video::-webkit-media-controls-enclosure {
    overflow: hidden;
  }
  #backButton {
    position: fixed;
    top: 20px; left: 20px;
    background: rgba(0,0,0,0.6);
    color: yellow; /* más visible */
    font-weight: bold;
    border: none; border-radius: 50%;
    padding: 12px 18px;
    font-size: 22px; /* más grande */
    cursor: pointer;
    display: none; z-index: 10000;
  }
  #activateSound {
    position: fixed;
    bottom: 30px; right: 30px;
    background: rgba(255,255,255,0.9);
    color: #000;
    border: none; border-radius: 25px;
    padding: 10px 20px; font-size: 16px;
    cursor: pointer;
    display: none;
    z-index: 10001;
  }
</style>
</head>
<body>

<video id="movie" controls playsinline webkit-playsinline
       controlslist="nodownload noremoteplayback noplaybackrate" 
       disablePictureInPicture>
  <source src="https://ia801801.us.archive.org/27/items/pets-united-2020-latino-1080-streaming-latino/bad%20boy%203.ia.mp4" type="video/mp4">
  Tu navegador no soporta el video.
</video>

<button id="backButton">⟵</button>
<button id="activateSound">Activar sonido</button>

<script>
const movie = document.getElementById('movie');
const backButton = document.getElementById('backButton');
const activateSound = document.getElementById('activateSound');

// ==== CONFIGURACIÓN ====
const adInterval = 15*60; // minutos * 60 = segundos
const ads = [
  "PAQUETERIA  GLOBAL EXPRESS.mp4",
  "PROMO NEGOCIOS.mp4"
];
let currentAdIndex = 0;
// ======================

let nextAdTime = adInterval;
let adPlaying = false;
let hideTimeout;

const isAndroid = /Android/i.test(navigator.userAgent);
let movieTimeBeforeAd = 0;
let soundActivated = localStorage.getItem("soundActivated") === "true";

// Mostrar botón regresar al tocar pantalla
document.addEventListener('click', () => {
  backButton.style.display = 'block';
  clearTimeout(hideTimeout);
  hideTimeout = setTimeout(()=>{ backButton.style.display='none'; }, 4000);
});
backButton.addEventListener('click', ()=>{ window.location.href='index.html'; });

// Ajustar tamaño del video
function adjustVideoSize(){
  movie.style.width = window.innerWidth + "px";
  movie.style.height = window.innerHeight + "px";
}
window.addEventListener('resize', adjustVideoSize);
window.addEventListener('orientationchange', adjustVideoSize);
adjustVideoSize();

// ===== PERMITIR ROTACIÓN NATURAL EN ANDROID =====
if (isAndroid && screen.orientation) {
  window.addEventListener("orientationchange", () => {
    adjustVideoSize();
  });
}

// ======== FIX: Mostrar botón en fullscreen Android =========
function setupFullscreenEvents() {
  function handleFullscreenChange() {
    if (document.fullscreenElement || document.webkitFullscreenElement) {
      movie.addEventListener('click', showBackButtonTemp);
    } else {
      backButton.style.display = 'none';
      movie.removeEventListener('click', showBackButtonTemp);
    }
  }
  document.addEventListener('fullscreenchange', handleFullscreenChange);
  document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
}

function showBackButtonTemp() {
  backButton.style.display = 'block';
  clearTimeout(hideTimeout);
  hideTimeout = setTimeout(()=>{ backButton.style.display='none'; }, 4000);
}
setupFullscreenEvents();
// ============================================================

// Temporizador para anuncios
movie.addEventListener('timeupdate', () => {
  if(!adPlaying && movie.currentTime >= nextAdTime){
    nextAdTime += adInterval;
    playAdsSequence();
  }
});

// Función para reproducir anuncios
async function playAdsSequence(){
  adPlaying = true;
  movieTimeBeforeAd = movie.currentTime;
  movie.pause();

  const originalSrc = movie.querySelector('source').src;
  const originalType = movie.querySelector('source').type;

  const adsToPlay = 2;

  for(let i=0; i<adsToPlay; i++){
    const adSrc = ads[currentAdIndex];
    currentAdIndex = (currentAdIndex + 1) % ads.length;
    movie.src = adSrc;
    movie.querySelector('source').type = "video/mp4";
    movie.load();

    if(isAndroid){
      if(soundActivated){
        movie.muted = false;
        await movie.play().catch(()=>{});
      } else {
        movie.muted = true;
        try{ await movie.play(); } catch(e){}
        activateSound.style.display = 'block';
      }
    } else {
      movie.muted = false;
      await movie.play().catch(()=>{});
    }

    activateSound.onclick = () => {
      movie.muted = false;
      movie.play().catch(()=>{});
      activateSound.style.display = 'none';
      soundActivated = true;
      localStorage.setItem("soundActivated","true");
    };

    await new Promise(resolve => {
      movie.onended = resolve;
    });
  }

  movie.src = originalSrc;
  movie.querySelector('source').type = originalType;
  movie.load();
  movie.currentTime = movieTimeBeforeAd;
  movie.muted = false;
  movie.playbackRate = 1.0;
  movie.play().catch(()=>{});
  adPlaying = false;
  activateSound.style.display = 'none';
}

document.addEventListener('touchstart', ()=>{
  movie.load();
  if(isAndroid && !soundActivated){
    movie.muted = false;
    soundActivated = true;
    localStorage.setItem("soundActivated","true");
  }
}, {once:true});

movie.addEventListener('seeking', ()=>{
  if(adPlaying) return;
  movie.playbackRate = 2.0;
});
movie.addEventListener('seeked', ()=>{
  movie.playbackRate = 1.0;
});
</script>

</body>
</html>























