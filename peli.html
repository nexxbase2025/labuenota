
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>LA PELI DE LA SEMANA</title>
<style>
  body {
    margin:0; padding:0;
    background:#000;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    overflow:hidden;
  }
  #video-container {
    position: relative;
    width: 100%;
    max-width: 900px;
  }
  video {
    width: 100%;
    height: auto;
    display:block;
    background:#000;
  }
  #ad-video {
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    display:none;
    z-index:10;
    background:#000;
  }
  #back-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    padding: 10px 18px;
    background: #ff6a00cc;
    color: white;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    z-index: 9999;
    display: none;
    opacity: 0.9;
    transition: opacity 0.3s;
  }
</style>
</head>
<body>
<div id="video-container">
  <video id="main-video" controls playsinline>
    <source src="https://ia800802.us.archive.org/5/items/idiocracia-2006-brrip-m-720p-x-264-ac-3-es/Idiocracia%20%282006%29%20%5BBRrip%20m720p%20x264%20AC3%28ES%29%5D.mp4" type="video/mp4">
    Tu navegador no soporta HTML5 video.
  </video>
  <video id="ad-video" playsinline></video>
</div>

<button id="back-btn">⬅ Regresar</button>

<script>
const mainVideo = document.getElementById('main-video');
const adVideo = document.getElementById('ad-video');
const backBtn = document.getElementById('back-btn');

// Configuración de anuncios
const adInterval = 10 * 60; // cada 10 minutos
const adVideoSrc = "https://ia601300.us.archive.org/15/items/youtube-L4PVw0oaZSo/L4PVw0oaZSo.mp4";
let nextAdTime = adInterval;
let adPlaying = false;

// Pausar radio (del index.html) durante video/anuncio
const radioAudio = window.opener?.document.getElementById('audio') || null;

// Función mostrar botón por 3 segundos
let backBtnTimeout;
function showBackButtonTemp(){
  backBtn.style.display = 'block';
  clearTimeout(backBtnTimeout);
  backBtnTimeout = setTimeout(()=>{ backBtn.style.display = 'none'; }, 3000);
}

// Botón regresar
backBtn.addEventListener('click', () => { window.close(); });

// Mostrar botón al tocar pantalla
document.addEventListener('click', showBackButtonTemp);
document.addEventListener('touchstart', showBackButtonTemp);

// Manejo de anuncios
mainVideo.addEventListener('timeupdate', () => {
  if(!adPlaying && mainVideo.currentTime >= nextAdTime){
    playAd();
  }
});

function playAd(){
  adPlaying = true;

  mainVideo.pause();

  // Pausar radio
  if(radioAudio && !radioAudio.paused){
    radioAudio.pause();
    radioAudio.wasPlaying = true;
  } else if(radioAudio){
    radioAudio.wasPlaying = false;
  }

  adVideo.src = adVideoSrc;
  adVideo.controls = false;
  adVideo.style.display = 'block';
  adVideo.play().catch(()=>{});

  adVideo.onended = () => {
    adVideo.style.display = 'none';
    adVideo.src = '';
    adPlaying = false;

    mainVideo.play(); // reanudar película
    if(radioAudio && radioAudio.wasPlaying){
      radioAudio.play().catch(()=>{});
    }

    nextAdTime += adInterval;
  };
}

// Pausar radio al iniciar película si no hay anuncio
mainVideo.addEventListener('play', () => {
  if(radioAudio && !adPlaying && !radioAudio.paused){
    radioAudio.pause();
    radioAudio.wasPlaying = true;
  }
});

// Reanudar radio al pausar película si no hay anuncio
mainVideo.addEventListener('pause', () => {
  if(radioAudio && !adPlaying && radioAudio.wasPlaying){
    radioAudio.play().catch(()=>{});
  }
});

// iOS / Android playsinline compat
mainVideo.addEventListener('webkitbeginfullscreen', () => { mainVideo.pause(); });
adVideo.addEventListener('webkitbeginfullscreen', () => { adVideo.pause(); });
</script>
</body>
</html>



